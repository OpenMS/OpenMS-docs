ProteomicsLFQ
=============


ProteomicsLFQ performs label-free quantification of peptides and proteins.

## Input

- Spectra in mzML format
- Identifications in idXML or mzIdentML format with posterior error probabilities as score type. To generate those we
  suggest to run:
  - PeptideIndexer to annotate target and decoy information.
  - PSMFeatureExtractor to annotate percolator features.
  - PercolatorAdapter tool (score_type = 'q-value', -post-processing-tdc).
  - IDFilter (pep:score = 0.01) to filter PSMs at 1% FDR.
- An experimental design file:

  ```{seealso}
  [Experimental Design](https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/nightly/html/classOpenMS_1_1ExperimentalDesign.html) for details.
  ```
- A protein database in with appended decoy sequences in FASTA format.
  (e.g., generated by the [OpenMS DecoyDatabase tool](https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/nightly/html/namespaceOpenMS.html)).
  Processing:
  ProteomicsLFQ has different methods to extract features: ID-based (targeted only), or both ID-based and untargeted.
  -  The first method uses targeted feature dectection using RT and m/z information derived from identification data to
     extract features.
	 ```{note}
	 Only identifications found in a particular MS run are used to extract features in the same run. No transfer of IDs
	 (match between runs) is performed.
	 ```
  - The second method adds untargeted feature detection to obtain quantities from unidentified features. Transfer of Ids
    (match between runs) is performed by transfering feature identifications to coeluting, unidentified features with
	similar mass and RT in other runs.

## Requantification

Optionally, a requantification step is performed that tries to fill NA values. If a peptide has been quantified in
more than half of all maps, the peptide is selected for requantification. In that case, the mean observed RT
(and theoretical m/z) of the peptide is used to perform a second round of targeted extraction.

## Output

Output format are as follows:

- mzTab file with analysis results.
- MSstats file with analysis results for statistical downstream analysis in MSstats.
- ConsensusXML file for visualization and further processing in OpenMS.

Potential scripts to perform the search can be found under `src/tests/topp/ProteomicsLFQTestScripts`.
